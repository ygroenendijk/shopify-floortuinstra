{%- liquid
  # Image assigns
  assign max_width = null
  if section.settings.container_width == ''
    assign max_width = 1360
  endif
-%}

{%- comment -%} Capture container content {%- endcomment -%}
{%- capture container_content -%}

  {% comment %} Create content position class {% endcomment %}
  {%- capture content_position -%}
    {{ section.settings.position_horizontal }} {{ section.settings.position_vertical }} {{ section.settings.text_align }}
  {%- endcapture -%}

  {% comment %} Banner wrapper {% endcomment %}
  <div class="image-banner__wrapper relative flex h-auto {{ content_position }} {{ section.settings.min_ratio_mobile }} {{ section.settings.min_ratio_desktop }}" {{ section.shopify_attributes }}>

    {% comment %} Banner image {% endcomment %}
    {%- liquid
      assign image_class = 'h-full w-full object-cover'
      assign image_class_desktop = image_class | append: ' hidden md:block'
      assign image_class_mobile = image_class | append: ' md:hidden'

      # Assign mobile image
      assign image_mobile = section.settings.image_desktop
      if section.settings.image_mobile != blank
        assign image_mobile = section.settings.image_mobile
      endif
    -%}

    <div class="image-banner__image absolute inset-0">
      {% comment %} Desktop image {% endcomment %}
      {%- render 'format-image',
        image_object: section.settings.image_desktop,
        class: image_class_desktop,
        max_width: max_width,
        lazy: section.settings.image_lazy
      -%}

      {% comment %} Mobile image {% endcomment %}
      {%- if image_mobile != blank -%}
        {%- render 'format-image',
          image_object: image_mobile,
          class: image_class_mobile,
          max_width: 768,
          lazy: section.settings.image_lazy
        -%}
      {%- endif -%}
    </div>

    {% comment %} Banner content {% endcomment %}
    <div class="image-banner__content relative mx-element-spacing my-12 inline-flex max-w-[80%] flex-col gap-y-4 p-8 md:my-20 md:max-w-screen-md md:px-12 {{ section.settings.content_color_scheme -}}">
      {% comment %} Heading {% endcomment %}
      {%- if section.settings.heading != blank -%}
        <{{ section.settings.heading_element }} class="{{- section.settings.heading_size }} {{ section.settings.heading_color -}}">
          {{- section.settings.heading | escape -}}
        </{{ section.settings.heading_element }}>
      {%- endif -%}

      {% comment %} Text {% endcomment %}
      {%- if section.settings.text != blank -%}
        <p class="{{- section.settings.text_color -}}">
          {{- section.settings.text | escape -}}
        </p>
      {%- endif -%}

      {% comment %} Buttons {% endcomment %}
      {%- liquid
        # First button
        assign button_1 = false
        if section.settings.button_label_1 != blank
          assign button_1 = true
        endif

        # Second button
        assign button_2 = false
        if section.settings.button_label_2 != blank
          assign button_2 = true
        endif

        # Button alligment
        case section.settings.text_align
          when 'text-left'
            assign buttons_alignment = 'justify-start'
          when 'text-center'
            assign buttons_alignment = 'justify-center'
          when 'text-right'
            assign buttons_alignment = 'justify-end'
        endcase
      -%}

      {%- if button_1 or button_2 -%}
        <div class="image-banner__buttons mt-4 flex items-center gap-element-spacing first:mt-0 {{ buttons_alignment -}}">
          {% comment %} Button 1 {% endcomment %}
          {%- if button_1 -%}
            <a
              href="{{ section.settings.button_url_1 | default: '#' }}"
              class="button {{ section.settings.button_type_1 }}{% if section.settings.button_url_1 == blank %} disabled{% endif %}"
            >
              {{- section.settings.button_label_1 | escape -}}
            </a>
          {%- endif -%}

          {% comment %} Button 2 {% endcomment %}
          {%- if button_2 -%}
            <a
              href="{{ section.settings.button_url_2 | default: '#' }}"
              class="button {{ section.settings.button_type_2 }}{% if section.settings.button_url_2 == blank %} disabled{% endif %}"
            >
              {{- section.settings.button_label_2 | escape -}}
            </a>
          {%- endif -%}
        </div>
      {%- endif -%}
    </div>
  </div>
{%- endcapture -%}

{% comment %} Container class {% endcomment %}
{%- liquid
  assign container_class = 'image-banner'

  # Container width
  assign container_class = container_class | append: ' ' | append: section.settings.container_width

  # Remove y margin if section is full width
  if section.settings.container_width == 'container--full'
    assign container_class = container_class | append: ' my-0'
  endif
-%}

{%- comment -%} Render the content {%- endcomment -%}
{%- render 'format-container', content: container_content, class: container_class -%}

{% schema %}
  {
    "name": "Image banner",
    "tag": "section",
    "class": "image-banner-section",
    "settings": [
      {
        "type": "header",
        "content": "Appearance settings"
      },
      {
        "type": "select",
        "id": "container_width",
        "label": "Section width",
        "default": "",
        "options": [
          {
            "value": "",
            "label": "Default"
          },
          {
            "value": "container--wide",
            "label": "Wide"
          },
          {
            "value": "container--full",
            "label": "Full"
          }
        ]
      },
      {
        "type": "select",
        "id": "min_ratio_mobile",
        "label": "Section minimum ratio mobile",
        "default": "aspect-[9/16]",
        "options": [
          {
            "value": "",
            "label": "Default"
          },
          {
            "value": "aspect-[5/2]",
            "label": "5x2"
          },
          {
            "value": "aspect-[2/1]",
            "label": "2x1"
          },
          {
            "value": "aspect-[16/9]",
            "label": "16x9"
          },
          {
            "value": "aspect-[4/3]",
            "label": "4x3"
          },
          {
            "value": "aspect-[1/1]",
            "label": "1x1"
          },
          {
            "value": "aspect-[3/4]",
            "label": "3x4"
          },
          {
            "value": "aspect-[9/16]",
            "label": "9x16"
          }
        ]
      },
      {
        "type": "select",
        "id": "min_ratio_desktop",
        "label": "Section minimum ratio desktop",
        "info": "Bigger then 768 pixels",
        "default": "md:aspect-[16/9]",
        "options": [
          {
            "value": "",
            "label": "Default (same as mobile)"
          },
          {
            "value": "md:aspect-[5/2]",
            "label": "5x2"
          },
          {
            "value": "md:aspect-[2/1]",
            "label": "2x1"
          },
          {
            "value": "md:aspect-[16/9]",
            "label": "16x9"
          },
          {
            "value": "md:aspect-[4/3]",
            "label": "4x3"
          },
          {
            "value": "md:aspect-[1/1]",
            "label": "1x1"
          },
          {
            "value": "md:aspect-[3/4]",
            "label": "3x4"
          },
          {
            "value": "md:aspect-[9/16]",
            "label": "9x16"
          }
        ]
      },
      {
        "type": "header",
        "content": "Image settings"
      },
      {
        "type": "image_picker",
        "id": "image_desktop",
        "label": "Desktop image",
        "info": "Visible 768px >. Max. size: 4472 x 4472 px (20MB)."
      },
      {
        "type": "image_picker",
        "id": "image_mobile",
        "label": "Mobile image",
        "info": "Visible < 768px. Max. size: 4472 x 4472 px (20MB)."
      },
      {
        "type": "checkbox",
        "id": "image_lazy",
        "label": "Lazyload image",
        "default": true,
        "info": "For page speed, disable if the image is directly visible on mobile and desktop"
      },
      {
        "type": "header",
        "content": "Content settings"
      },
      {
        "type": "select",
        "id": "content_color_scheme",
        "label": "Color scheme",
        "default": "",
        "options": [
          {
            "value": "",
            "label": "Default"
          },
          {
            "value": "color-scheme color-scheme--primary",
            "label": "Primary",
            "group": "Theme"
          },
          {
            "value": "color-scheme color-scheme--secondary",
            "label": "Secondary",
            "group": "Theme"
          },
          {
            "value": "color-scheme color-scheme--accent",
            "label": "Accent",
            "group": "Theme"
          },
          {
            "value": "color-scheme color-scheme--white",
            "label": "White",
            "group": "Standard"
          },
          {
            "value": "color-scheme color-scheme--gray",
            "label": "Gray",
            "group": "Standard"
          },
          {
            "value": "color-scheme color-scheme--black",
            "label": "Black",
            "group": "Standard"
          }
        ]
      },
      {
        "type": "select",
        "id": "position_horizontal",
        "label": "Horizontal position",
        "default": "justify-center",
        "options": [
          {
            "value": "justify-start",
            "label": "Left"
          },
          {
            "value": "justify-center",
            "label": "Center"
          },
          {
            "value": "justify-end",
            "label": "Right"
          }
        ]
      },
      {
        "type": "select",
        "id": "position_vertical",
        "label": "Vertical position",
        "default": "items-center",
        "options": [
          {
            "value": "items-start",
            "label": "Top"
          },
          {
            "value": "items-center",
            "label": "Center"
          },
          {
            "value": "items-end",
            "label": "Bottom"
          }
        ]
      },
      {
        "type": "select",
        "id": "text_align",
        "label": "Text align",
        "default": "text-center",
        "options": [
          {
            "value": "text-left",
            "label": "Left"
          },
          {
            "value": "text-center",
            "label": "Center"
          },
          {
            "value": "text-right",
            "label": "Right"
          }
        ]
      },
      {
        "type": "header",
        "content": "Header settings"
      },
      {
        "type": "text",
        "id": "heading",
        "label": "Heading",
        "default": "I'm a heading"
      },
      {
        "type": "select",
        "id": "heading_element",
        "label": "Heading element",
        "default": "h2",
        "info": "Change the element of the heading for SEO.",
        "options": [
          {
            "value": "h1",
            "label": "H1"
          },
          {
            "value": "h2",
            "label": "H2"
          },
          {
            "value": "h3",
            "label": "H3"
          },
          {
            "value": "h4",
            "label": "H4"
          },
          {
            "value": "h5",
            "label": "H5"
          },
          {
            "value": "h6",
            "label": "H6"
          }
        ]
      },
      {
        "type": "select",
        "id": "heading_size",
        "label": "Heading size",
        "default": "h2",
        "info": "Change the style of the heading to only influence the look and feel.",
        "options": [
          {
            "value": "h1",
            "label": "H1"
          },
          {
            "value": "h2",
            "label": "H2"
          },
          {
            "value": "h3",
            "label": "H3"
          },
          {
            "value": "h4",
            "label": "H4"
          },
          {
            "value": "h5",
            "label": "H5"
          },
          {
            "value": "h6",
            "label": "H6"
          }
        ]
      },
      {
        "type": "select",
        "id": "heading_color",
        "label": "Color",
        "options": [
          {
            "value": "",
            "label": "Default"
          },
          {
            "value": "text-black",
            "label": "Black",
            "group": "Standard"
          },
          {
            "value": "text-white",
            "label": "White",
            "group": "Standard"
          },
          {
            "value": "text-primary",
            "label": "Primary",
            "group": "Theme"
          },
          {
            "value": "text-secondary",
            "label": "Secondary",
            "group": "Theme"
          },
          {
            "value": "text-accent",
            "label": "Accent",
            "group": "Theme"
          }
        ]
      },
      {
        "type": "header",
        "content": "Text settings"
      },
      {
        "type": "textarea",
        "id": "text",
        "label": "Text",
        "default": "I explain what the banner is for."
      },
      {
        "type": "select",
        "id": "text_color",
        "label": "Color",
        "options": [
          {
            "value": "",
            "label": "Default"
          },
          {
            "value": "text-black",
            "label": "Black",
            "group": "Standard"
          },
          {
            "value": "text-white",
            "label": "White",
            "group": "Standard"
          },
          {
            "value": "text-primary",
            "label": "Primary",
            "group": "Theme"
          },
          {
            "value": "text-secondary",
            "label": "Secondary",
            "group": "Theme"
          },
          {
            "value": "text-accent",
            "label": "Accent",
            "group": "Theme"
          }
        ]
      },
      {
        "type": "header",
        "content": "First button",
        "info": "Leave empty to hide the button."
      },
      {
        "type": "text",
        "id": "button_label_1",
        "label": "Label",
        "default": "Read more"
      },
      {
        "type": "url",
        "id": "button_url_1",
        "label": "Link"
      },
      {
        "type": "select",
        "id": "button_type_1",
        "label": "Type",
        "default": "",
        "options": [
          {
            "value": "",
            "label": "Default"
          },
          {
            "value": "button--primary",
            "label": "Primary"
          },
          {
            "value": "button--secondary",
            "label": "Secondary"
          },
          {
            "value": "button--outline",
            "label": "Outline"
          },
          {
            "value": "button--outline-white",
            "label": "Outline white"
          },
          {
            "value": "button--link",
            "label": "Link"
          }
        ]
      },
      {
        "type": "header",
        "content": "Second button",
        "info": "Leave empty to hide the button."
      },
      {
        "type": "text",
        "id": "button_label_2",
        "label": "Label",
        "default": "Read more"
      },
      {
        "type": "url",
        "id": "button_url_2",
        "label": "Link"
      },
      {
        "type": "select",
        "id": "button_type_2",
        "label": "Type",
        "default": "",
        "options": [
          {
            "value": "",
            "label": "Default"
          },
          {
            "value": "button--primary",
            "label": "Primary"
          },
          {
            "value": "button--secondary",
            "label": "Secondary"
          },
          {
            "value": "button--outline",
            "label": "Outline"
          },
          {
            "value": "button--outline-white",
            "label": "Outline white"
          },
          {
            "value": "button--link",
            "label": "Link"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Image banner"
      }
    ],
    "disabled_on": {
      "groups": ["header"]
    }
  }
{% endschema %}
